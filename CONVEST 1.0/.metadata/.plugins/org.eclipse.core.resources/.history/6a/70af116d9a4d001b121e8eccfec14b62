<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CONVEST</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <!-- Google fonts - Roboto-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,700">
    <!-- Bootstrap Select-->
    <link rel="stylesheet" href="vendor/bootstrap-select/css/bootstrap-select.min.css">
    <!-- owl carousel-->
    <link rel="stylesheet" href="vendor/owl.carousel/assets/owl.carousel.css">
    <link rel="stylesheet" href="vendor/owl.carousel/assets/owl.theme.default.css">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="css/style.default.css" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="css/custom.css">
    <!-- Favicon and apple touch icons-->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="57x57" href="img/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="72x72" href="img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="img/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="img/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="img/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="img/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="img/apple-touch-icon-152x152.png">
    <!-- Tweaks for older IEs--><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
  </head>
  <body>
    <div id="all">
      <!-- Top bar-->
      <div class="top-bar">
        <div class="container">
          <div class="row d-flex align-items-center">
            <div class="col-md-6 d-md-block d-none">
              <p>联系我们 +86 123456789 或者发送email至convest@gmail.com</p>
            </div>
            <div class="col-md-6">
              <div class="d-flex justify-content-md-end justify-content-between">
                <ul class="list-inline contact-info d-block d-md-none">
                  <li class="list-inline-item"><a href="#"><i class="fa fa-phone"></i></a></li>
                  <li class="list-inline-item"><a href="#"><i class="fa fa-envelope"></i></a></li>
                </ul>
                <div class="login"><a href="#" data-toggle="modal" data-target="#login-modal" class="login-btn"><i class="fa fa-sign-in"></i><span class="d-none d-md-inline-block">登录</span></a><a href="customer-register.jsp" class="signup-btn"><i class="fa fa-user"></i><span class="d-none d-md-inline-block">注册</span></a></div>
                
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Top bar end-->
      <!-- Login Modal-->
      <div id="login-modal" tabindex="-1" role="dialog" aria-labelledby="login-modalLabel" aria-hidden="true" class="modal fade">
        <div role="document" class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h4 id="login-modalLabel" class="modal-title">用户登录</h4>
              <button type="button" data-dismiss="modal" aria-label="Close" class="close"><span aria-hidden="true">×</span></button>
            </div>
            <div class="modal-body">
              <form action="个人中心.jsp" method="get">
                <div class="form-group">
                  <input id="email_modal" type="text" placeholder="email" class="form-control">
                </div>
                <div class="form-group">
                  <input id="password_modal" type="password" placeholder="密码" class="form-control">
                </div>
                <p class="text-center">
                  <button class="btn btn-template-outlined" onclick="login()"><i class="fa fa-sign-in"></i> 登录</button>
                </p>
              </form>
              <p class="text-center text-muted">还没注册？</p>
              <p class="text-center text-muted"><a href="customer-register.jsp"><strong>即刻注册</strong></a>! 只需一分钟，体验更多功能！</p>
            </div>
          </div>
        </div>
      </div>
      <!-- Login modal end-->
      <!-- Navbar Start-->
      <header class="nav-holder make-sticky">
        <div id="navbar" role="navigation" class="navbar navbar-expand-lg">
          <div class="container"><a href="首页.jsp" class="navbar-brand home"><img src="img/logo.png" alt="Universal logo" class="d-none d-md-inline-block"><img src="img/logo-small.png" alt="Universal logo" class="d-inline-block d-md-none"><span class="sr-only">Universal - go to homepage</span></a>
            <button type="button" data-toggle="collapse" data-target="#navigation" class="navbar-toggler btn-template-outlined"><span class="sr-only">Toggle navigation</span><i class="fa fa-align-justify"></i></button>
            <div id="navigation" class="navbar-collapse collapse">
              <ul class="nav navbar-nav ml-auto">
                <li class="nav-item dropdown menu-large"><a href="首页.jsp" >首 页 <b class="caret"></b></a>
                  
                </li>
                <li class="nav-item dropdown menu-large"><a href="高管信息.jsp">高管信息 <b class="caret"></b></a>
                  
                </li>
                <li class="nav-item dropdown menu-large"><a href="股票信息.jsp" >股票信息<b class="caret"></b></a>
                  
                </li>
                <li class="nav-item dropdown menu-large"><a href="社区资讯.jsp" >社区资讯 <b class="caret"></b></a>
                  
                </li>
                
                <li class="nav-item dropdown active"><a href="个人中心.jsp" >个人中心 <b class="caret"></b></a>
                  
                </li>
                <!-- ========== Contact dropdown end ==================-->
              </ul>
            </div>
            <div id="search" class="collapse clearfix">
              <form role="search" class="navbar-form">
                <div class="input-group">
                  <input type="text" placeholder="Search" class="form-control"><span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button></span>
                </div>
              </form>
            </div>
          </div>
        </div>
      </header>

      <!-- Navbar End-->
      
      <div id="heading-breadcrumbs">
        <div class="container">
          <div class="row d-flex align-items-center flex-wrap">
            <div class="col-md-7">
              <h1 class="h2">个人中心</h1>
            </div>
            <div class="col-md-5">
              <ul class="breadcrumb d-flex justify-content-end">
                <li class="breadcrumb-item"><a href="首页.jsp">首页</a></li>
                <li class="breadcrumb-item active">个人中心</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div id="content">
        <div class="container">
          <div class="row bar">
            <div id="customer-account" class="col-lg-9 clearfix">
              <p class="lead">密码修改与个人信息填写</p>
              <div class="box mt-5">
                <div class="heading">
                  <h3 class="text-uppercase">修改密码</h3>
                </div>
                <form>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="password_old">原密码</label>
                        <input id="password_old" type="password" class="form-control">
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="password_1">新密码</label>
                        <input id="password_1" type="password" class="form-control" onkeyup="validate()">
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="password_2">再次输入新密码</label>
                        <input id="password_2" type="password" class="form-control" onkeyup="validate()">
                      </div>
                    </div>
                  </div>
                   <div id="tishi"></div>
                  <div class="text-center">
                    <button type="submit" class="btn btn-template-outlined" onclick="submit()" id="btn"><i class="fa fa-save"></i> 保存新密码</button>
                  </div>
                </form>
              </div>
              <div class="bo3">
                <div class="heading">
                  <h3 class="text-uppercase">个人信息</h3>
                </div>
                <form>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="name">用户名</label>
                        <input id="name" type="text" class="form-control">
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="company">公司</label>
                        <input id="company" type="text" class="form-control">
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="code">邮编</label>
                        <input id="code" type="text" class="form-control">
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="address">地址</label>
                        <input id="address" type="text" class="form-control">
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="phone">电话</label>
                        <input id="phone" type="text" class="form-control">
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label for="email_account">Email</label>
                        <input id="email_account" type="text" class="form-control">
                      </div>
                    </div>
                    <div class="col-md-12 text-center">
                      <button type="submit" class="btn btn-template-outlined" "><i class="fa fa-save"></i> 保存修改结果</button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
            <div class="col-lg-3 mt-4 mt-lg-0">
              <!-- CUSTOMER MENU -->
              <div class="panel panel-default sidebar-menu">
                <div class="panel-heading">
                  <h3 class="h4 panel-title">Customer section</h3>
                </div>
                <div class="panel-body">
                  <ul class="nav nav-pills flex-column text-sm">
                    <li class="nav-item"><a href="个人中心.jsp" class="nav-link active"><i class="fa fa-list"></i> 个人信息</a></li>
                    <li class="nav-item"><a href="customer-wishlist.jsp" class="nav-link"><i class="fa fa-heart"></i> 邮件订阅记录</a></li>
           
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
     
      <!-- FOOTER -->
     <footer class="main-footer">
        <div class="container">
          <div class="row">
            <div class="col-lg-3">
              <h4 class="h6">联系方式</h4>
              <p>企业邮箱：<a href="mailto:CONVEST@gmail.com" rel="nofollow">CONVEST@gmail.com</a></p>
              <p>联系电话：+86 1234567</p>
              <p>工作时间：周一至周五：9:30-17:00</p>
              <hr>
              <h4 class="h6">真诚欢迎合作者的到来！</h4>
              
              <hr class="d-block d-lg-none">
            </div>
            <div class="col-lg-3">
              <h4 class="h6">数据来源</h4>
              <p><a href="http://zxgk.court.gov.cn/" target="_blank" rel="nofollow">中国执行信息公开网</a></p>
              <p><a href="http://www.sipo.gov.cn/" target="_blank" rel="nofollow">国家知识产权局</a></p>
              <p><a href="http://sbj.cnipa.gov.cn/" target="_blank" rel="nofollow">商标局</a></p>
              <p><a href="http://www.ncac.gov.cn/" target="_blank" rel="nofollow">版权局</a></p>
              
            </div>
           
            <div class="col-lg-3">
              <h4 class="h6">办公地址</h4>
              <p class="text-uppercase"><strong>中国上海杨浦区</strong><br>国定路777号 <br>上海财经大学<br>信息管理与工程学院<br><strong></strong></p><a href="contact.jsp" class="btn btn-template-main">前往联系界面</a>
              <hr class="d-block d-lg-none">
            </div>
            
          </div>
        </div>
        <div class="copyrights">
          <div class="container">
            <div class="row">
              <div class="col-lg-4 text-center-md">
                <p>&copy; 2020. CONVEST</p>
              </div>
              
            </div>
          </div>
        </div>
      </footer>
    </div>
    <!-- Javascript files-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/popper.js/umd/popper.min.js"> </script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="vendor/jquery.cookie/jquery.cookie.js"> </script>
    <script src="vendor/waypoints/lib/jquery.waypoints.min.js"> </script>
    <script src="vendor/jquery.counterup/jquery.counterup.min.js"> </script>
    <script src="vendor/owl.carousel/owl.carousel.min.js"></script>
    <script src="vendor/owl.carousel2.thumbs/owl.carousel2.thumbs.min.js"></script>
    <script src="js/jquery.parallax-1.1.3.js"></script>
    <script src="vendor/bootstrap-select/js/bootstrap-select.min.js"></script>
    <script src="vendor/jquery.scrollto/jquery.scrollTo.min.js"></script>
    <script src="js/front.js"></script>
  </body>
  
   <script>
     
     
     function submit(){
    	 var password = document.getElementById("password_old").value;
         $.ajax({
             url:"querypwd",
             type: "post",
             async: false,
             data: {
      	        user_id: 1
              },
             success: function (data) {
            	 if(data[0].password == password){
            		change(); 
            	 }
            	 else{alert("原密码填写错误");blank();}
             }, error: function (data) {
           	     alert("处理异常");
           	     console.log(data);
         }
     });
    }
     </script>
      <script>
     function validate() {
    	 var password1 = document.getElementById("password_1").value;
    	 var password2 = document.getElementById("password_2").value;
    	 if(password1 == password2) {
    	 document.getElementById("tishi").innerHTML="<font color='green'>密码相同</font>";
    	 document.getElementById("btn").disabled = false;
    	 }
    	 else {
    	 document.getElementById("tishi").innerHTML="<font color='red'>密码不同</font>";
    	 document.getElementById("btn").disabled = true;
    	 }
    	 }
     </script>
     
     <script>
     function change(){
    	 var password = document.getElementById("password_1").value;
         $.ajax({
             url:"updatepwd",
             type: "post",
             async: false,
             data: {
      	        password:password
      	        },
             success: function (data) {
            	 alert("修改成功！");
            	 var url = "首页.jsp";
                 window.location.href = url;
             }, error: function (data) {
           	     alert("处理异常");
           	     console.log(data);
         }
     });
    }
     </script>
    
     <script>     
     //运行时取数据加入固定展示页面，并在修改的框中也展示数据，便于修改
     $(document).ready(function () {
    	 var label="<label class=\"control-label col-md-3\" >";
    	 var lab="<label class=\"control-label col-md-3\" style=\"text-align: center;\">";
    	 var info;
         $.ajax({
             url:"querypwd",
             type: "post",
             async: false,
             success: function (data) {
            	 console.log(data);
            	 data[0].phone = data[0].phone==null? "" :data[0].phone;
            	 data[0].birthday = data[0].birthday==null? "" :data[0].birthday;
            	 data[0].location = data[0].location==null? "" :data[0].location;
            	 data[0].email = data[0].email==null? "" :data[0].email;
            	 
            	 $("#name").append(label + "姓名" + "</label>" + lab + data[0].username +"</label>");
            	 if(data[0].sex==0){$("#sex").append(label + "性别" + "</label>" + lab + "女" +"</label>");}
            	 if(data[0].sex==1){$("#sex").append(label + "性别" + "</label>" + lab + "男" +"</label>");}
            	 $("#phone").append(label + "联系方式" + "</label>" + lab + data[0].phone +"</label>");
            	 $("#birthday").append(label + "出生日期" + "</label>" + lab + data[0].birthday +"</label>");
            	 $("#location").append(label + "所在地" + "</label>" + lab + data[0].location +"</label>");
            	 $("#email").append(label + "电子邮箱" + "</label>" + lab + data[0].email +"</label>");
            	 document.getElementById("n").value = data[0].username;
            	 document.getElementById("p").value = data[0].phone;
            	 document.getElementById("b").value = data[0].birthday;
            	 document.getElementById("l").value = data[0].location;
            	 document.getElementById("e").value = data[0].email;
            	 if(data[0].sex==0){$("#s").append("<input value=1 type=\"radio\" name=\"bg\" />男&nbsp;&nbsp;&nbsp;&nbsp;<input value=0 type=\"radio\" checked=\"checked\"  name=\"bg\"/>女");}
            	 else if(data[0].sex==1){$("#s").append("<input value=1 type=\"radio\" checked=\"checked\" name=\"bg\" />男&nbsp;&nbsp;&nbsp;&nbsp;<input value=0 type=\"radio\"  name=\"bg\"/>女");}
            	 else {
            		 $("#s").append("<input value=1 type=\"radio\" name=\"bg\" />男&nbsp;&nbsp;&nbsp;&nbsp;<input value=0 type=\"radio\"  name=\"bg\"/>女");
            	 };
            	 layui.use('laydate', function(){
                	 var laydate = layui.laydate;
                	 
                	 laydate.render({
                         elem: '#b'
                         , value: new Date(data[0].birthday)
                    });
                 });
             
             }, error: function (data) {
           	     alert("处理异常");
           	     console.log(data);
         }
     });
     })
     </script>
     
     <script>
     //更新个人信息
     function changeinfo(){
    	 var username = document.getElementById("n").value;
    	 var phone = document.getElementById("p").value;
    	 var birthday = document.getElementById("b").value;
    	 var location = document.getElementById("l").value;
    	 var email = document.getElementById("e").value;
    	 var sex = $(':radio[name="bg"]:checked').val();
    	 if(sex == null) {sex = 1};
         $.ajax({
             url:"updateinfo",
             type: "post",
             async: false,
             data: {
      	        username:username,
      	        phone:phone,
      	        birthday:birthday,
      	        location:location,
      	        email:email,
      	        sex:sex,
              },
             success: function (data) {
            	 window.location.reload();
             }, error: function (data) {
           	     alert("处理异常");
           	     console.log(data);
         }
     });
     }
    
     </script>
   
</html>